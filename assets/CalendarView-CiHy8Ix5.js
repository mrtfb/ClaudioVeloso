import{d as E,u as N,a as I,l as A,c as m,o as O,b as n,e as t,t as l,F as D,h as f,p as y,g as b,z as S,i as r,_ as P}from"./index-D0NTzVGO.js";const z={class:"container"},B={class:"card mb-6"},L={class:"flex items-center justify-between mb-4"},V={class:"text-xl font-semibold text-gray-900 capitalize"},H={class:"card"},Y={class:"grid grid-cols-7 gap-1 mb-2"},Q={class:"grid grid-cols-7 gap-1"},G={class:"space-y-1"},U={class:"font-bold truncate text-center mb-1",style:{"line-height":"1.2"}},q={class:"truncate text-center text-xs opacity-75",style:{"line-height":"1.1"}},K={key:0,class:"text-xs text-white font-bold bg-gray-700 rounded px-1",style:{"text-shadow":"1px 1px 1px rgba(0,0,0,0.5)"}},R={class:"card mt-6"},W={key:0,class:"text-center py-4 text-gray-600"},X={key:1,class:"space-y-3"},Z={class:"font-bold text-gray-900 text-base"},$={class:"text-sm text-gray-800 font-medium"},j={key:0,class:"text-sm text-gray-900 font-bold"},ee={class:"text-right"},te={class:"text-xs px-3 py-1 rounded-full font-black",style:{"font-weight":"900","letter-spacing":"0.5px",color:"black"}},se=E({__name:"CalendarView",setup(ae){const a=N(),i=I(),d=A(new Date),x=m(()=>{if(a.userType==="installer"&&a.user?.id){const u=i.getJobsForInstaller(a.user.id).filter(e=>e.scheduledDate&&(e.status==="accepted"||e.status==="in_progress")),o=i.pendingJobs.filter(e=>e.scheduledDate&&!e.installerId);return[...u,...o].sort((e,s)=>(e.scheduledDate?.getTime()||0)-(s.scheduledDate?.getTime()||0))}else if(a.userType==="client"&&a.user?.id)return i.getJobsForClient(a.user.id).filter(u=>u.scheduledDate).sort((u,o)=>(u.scheduledDate?.getTime()||0)-(o.scheduledDate?.getTime()||0));return[]}),k=m(()=>d.value.toLocaleDateString("pt-PT",{month:"long",year:"numeric"})),w=m(()=>{const u=d.value.getFullYear(),o=d.value.getMonth(),e=new Date(u,o,1),s=new Date(e);s.setDate(s.getDate()-e.getDay());const _=[],c=new Date(s);for(let v=0;v<42;v++){let p=[];if(a.userType==="installer"&&a.user?.id){const h=i.getJobsForInstaller(a.user.id).filter(g=>g.scheduledDate&&g.scheduledDate.toDateString()===c.toDateString()&&(g.status==="accepted"||g.status==="in_progress")),F=i.pendingJobs.filter(g=>g.scheduledDate&&g.scheduledDate.toDateString()===c.toDateString()&&!g.installerId);p=[...h,...F]}else a.userType==="client"&&a.user?.id?p=i.getJobsForClient(a.user.id).filter(h=>h.scheduledDate&&h.scheduledDate.toDateString()===c.toDateString()):p=i.jobs.filter(h=>h.scheduledDate&&h.scheduledDate.toDateString()===c.toDateString());const J={date:new Date(c),isCurrentMonth:c.getMonth()===o,isToday:c.toDateString()===new Date().toDateString(),jobs:p};_.push(J),c.setDate(c.getDate()+1)}return _});function T(){d.value=new Date(d.value.getFullYear(),d.value.getMonth()-1,1)}function C(){d.value=new Date(d.value.getFullYear(),d.value.getMonth()+1,1)}function M(){d.value=new Date}return O(()=>{i.loadFromStorage(),console.log("All jobs:",i.jobs),console.log("Scheduled jobs:",x.value),console.log("Current user:",a.user),console.log("User type:",a.userType)}),(u,o)=>(r(),n("div",z,[t("div",B,[t("div",L,[t("button",{onClick:T,class:"p-2 hover:bg-gray-100 rounded-lg"},o[0]||(o[0]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),t("h2",V,l(k.value),1),t("button",{onClick:C,class:"p-2 hover:bg-gray-100 rounded-lg"},o[1]||(o[1]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))]),t("button",{onClick:M,class:"btn btn-secondary w-full"}," Hoje ")]),t("div",H,[t("div",Y,[(r(),n(D,null,f(["Dom","Seg","Ter","Qua","Qui","Sex","SÃ¡b"],e=>t("div",{key:e,class:"text-center text-sm font-medium text-gray-600 p-2"},l(e),1)),64))]),t("div",Q,[(r(!0),n(D,null,f(w.value,e=>(r(),n("div",{key:e.date.toISOString(),class:y(["min-h-20 p-1 border border-gray-100 rounded-lg",e.isCurrentMonth?"bg-white":"bg-gray-50",e.isToday?"bg-blue-50 border-blue-200":""])},[t("div",{class:y(["text-sm font-medium mb-1",e.isCurrentMonth?"text-gray-900":"text-gray-400",e.isToday?"text-blue-600":""])},l(e.date.getDate()),3),t("div",G,[(r(!0),n(D,null,f(e.jobs.slice(0,2),s=>(r(),n("div",{key:s.id,class:"rounded-2xl p-3 shadow-lg border-2",style:S({backgroundColor:s.status==="pending"?"#fde047":s.status==="accepted"?"#93c5fd":s.status==="in_progress"?"#86efac":"#d1d5db",borderColor:s.status==="pending"?"#facc15":s.status==="accepted"?"#60a5fa":s.status==="in_progress"?"#4ade80":"#9ca3af",color:"black",fontSize:"11px",lineHeight:"1.3",boxShadow:"0 8px 16px rgba(0, 0, 0, 0.15), 0 2px 4px rgba(0, 0, 0, 0.1)"})},[t("div",U,l(s.title),1),t("div",q,l(s.scheduledDate?s.scheduledDate.toLocaleTimeString("pt-PT",{hour:"2-digit",minute:"2-digit"}):""),1)],4))),128)),e.jobs.length>2?(r(),n("div",K," +"+l(e.jobs.length-2)+" mais ",1)):b("",!0)])],2))),128))])]),t("div",R,[o[2]||(o[2]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"PrÃ³ximos Trabalhos",-1)),x.value.length===0?(r(),n("div",W," Nenhum trabalho agendado ")):(r(),n("div",X,[(r(!0),n(D,null,f(x.value.slice(0,5),e=>(r(),n("div",{key:e.id,class:"flex items-center justify-between p-3 rounded-lg border-2 shadow-md",style:S({backgroundColor:e.status==="pending"?"#fde047":e.status==="accepted"?"#93c5fd":e.status==="in_progress"?"#86efac":"#d1d5db",borderColor:e.status==="pending"?"#facc15":e.status==="accepted"?"#60a5fa":e.status==="in_progress"?"#4ade80":"#9ca3af",color:"black"})},[t("div",null,[t("div",Z,l(e.title),1),t("div",$,l(e.location),1),e.scheduledDate?(r(),n("div",j," ðŸ“… "+l(e.scheduledDate.toLocaleDateString("pt-PT",{day:"2-digit",month:"2-digit",year:"numeric"}))+" Ã s "+l(e.scheduledDate.toLocaleTimeString("pt-PT",{hour:"2-digit",minute:"2-digit"})),1)):b("",!0)]),t("div",ee,[t("div",te,l(e.status==="pending"?"PENDENTE":e.status==="accepted"?"AGENDADO":e.status==="in_progress"?"EM ANDAMENTO":"DESCONHECIDO"),1)])],4))),128))]))])]))}}),ne=P(se,[["__scopeId","data-v-9d64d184"]]);export{ne as default};
