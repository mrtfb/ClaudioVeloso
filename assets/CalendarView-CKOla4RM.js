import{d as F,u as E,a as N,l as I,c as _,o as P,b as o,e as t,t as l,F as D,h as x,p as m,g as f,i as r,_ as A}from"./index-XMlooSuU.js";const L={class:"container"},O={class:"card mb-6"},B={class:"flex items-center justify-between mb-4"},z={class:"text-xl font-semibold text-gray-900 capitalize"},V={class:"card"},Y={class:"grid grid-cols-7 gap-1 mb-2"},H={class:"grid grid-cols-7 gap-1"},Q={class:"space-y-1"},$=["title"],G={class:"font-black text-white",style:{"font-size":"11px","line-height":"1","text-shadow":"1px 1px 1px rgba(0,0,0,0.5)"}},U={class:"truncate font-bold text-white",style:{"font-size":"11px","line-height":"1.1","text-shadow":"1px 1px 1px rgba(0,0,0,0.5)"}},q={key:0,class:"text-xs text-white font-bold bg-gray-700 rounded px-1",style:{"text-shadow":"1px 1px 1px rgba(0,0,0,0.5)"}},K={class:"card mt-6"},R={key:0,class:"text-center py-4 text-gray-600"},W={key:1,class:"space-y-3"},X={class:"font-bold text-gray-900 text-base"},Z={class:"text-sm text-gray-700 font-medium"},j={key:0,class:"text-sm text-gray-900 font-bold"},ee={class:"text-right"},te=F({__name:"CalendarView",setup(se){const a=E(),d=N(),i=I(new Date),y=_(()=>{if(a.userType==="installer"&&a.user?.id){const c=d.getJobsForInstaller(a.user.id).filter(e=>e.scheduledDate&&(e.status==="accepted"||e.status==="in_progress")),n=d.pendingJobs.filter(e=>e.scheduledDate&&!e.installerId);return[...c,...n].sort((e,s)=>(e.scheduledDate?.getTime()||0)-(s.scheduledDate?.getTime()||0))}else if(a.userType==="client"&&a.user?.id)return d.getJobsForClient(a.user.id).filter(c=>c.scheduledDate).sort((c,n)=>(c.scheduledDate?.getTime()||0)-(n.scheduledDate?.getTime()||0));return[]}),w=_(()=>i.value.toLocaleDateString("pt-PT",{month:"long",year:"numeric"})),S=_(()=>{const c=i.value.getFullYear(),n=i.value.getMonth(),e=new Date(c,n,1),s=new Date(e);s.setDate(s.getDate()-e.getDay());const v=[],u=new Date(s);for(let b=0;b<42;b++){let p=[];if(a.userType==="installer"&&a.user?.id){const h=d.getJobsForInstaller(a.user.id).filter(g=>g.scheduledDate&&g.scheduledDate.toDateString()===u.toDateString()&&(g.status==="accepted"||g.status==="in_progress")),J=d.pendingJobs.filter(g=>g.scheduledDate&&g.scheduledDate.toDateString()===u.toDateString()&&!g.installerId);p=[...h,...J]}else a.userType==="client"&&a.user?.id?p=d.getJobsForClient(a.user.id).filter(h=>h.scheduledDate&&h.scheduledDate.toDateString()===u.toDateString()):p=d.jobs.filter(h=>h.scheduledDate&&h.scheduledDate.toDateString()===u.toDateString());const M={date:new Date(u),isCurrentMonth:u.getMonth()===n,isToday:u.toDateString()===new Date().toDateString(),jobs:p};v.push(M),u.setDate(u.getDate()+1)}return v});function T(){i.value=new Date(i.value.getFullYear(),i.value.getMonth()-1,1)}function k(){i.value=new Date(i.value.getFullYear(),i.value.getMonth()+1,1)}function C(){i.value=new Date}return P(()=>{d.loadFromStorage(),console.log("All jobs:",d.jobs),console.log("Scheduled jobs:",y.value),console.log("Current user:",a.user),console.log("User type:",a.userType)}),(c,n)=>(r(),o("div",L,[t("div",O,[t("div",B,[t("button",{onClick:T,class:"p-2 hover:bg-gray-100 rounded-lg"},n[0]||(n[0]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])),t("h2",z,l(w.value),1),t("button",{onClick:k,class:"p-2 hover:bg-gray-100 rounded-lg"},n[1]||(n[1]=[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)]))]),t("button",{onClick:C,class:"btn btn-secondary w-full"}," Hoje ")]),t("div",V,[t("div",Y,[(r(),o(D,null,x(["Dom","Seg","Ter","Qua","Qui","Sex","SÃ¡b"],e=>t("div",{key:e,class:"text-center text-sm font-medium text-gray-600 p-2"},l(e),1)),64))]),t("div",H,[(r(!0),o(D,null,x(S.value,e=>(r(),o("div",{key:e.date.toISOString(),class:m(["min-h-20 p-1 border border-gray-100 rounded-lg",e.isCurrentMonth?"bg-white":"bg-gray-50",e.isToday?"bg-blue-50 border-blue-200":""])},[t("div",{class:m(["text-sm font-medium mb-1",e.isCurrentMonth?"text-gray-900":"text-gray-400",e.isToday?"text-blue-600":""])},l(e.date.getDate()),3),t("div",Q,[(r(!0),o(D,null,x(e.jobs.slice(0,2),s=>(r(),o("div",{key:s.id,class:m(["text-xs p-1 rounded font-bold",s.status==="pending"?"bg-yellow-500":s.status==="accepted"?"bg-blue-700":s.status==="in_progress"?"bg-green-700":"bg-gray-700"]),title:`${s.title} - ${s.scheduledDate?s.scheduledDate.toLocaleTimeString("pt-PT",{hour:"2-digit",minute:"2-digit"}):""}`},[t("div",G,l(s.scheduledDate?s.scheduledDate.toLocaleTimeString("pt-PT",{hour:"2-digit",minute:"2-digit"}):""),1),t("div",U,l(s.title),1)],10,$))),128)),e.jobs.length>2?(r(),o("div",q," +"+l(e.jobs.length-2)+" mais ",1)):f("",!0)])],2))),128))])]),t("div",K,[n[2]||(n[2]=t("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"PrÃ³ximos Trabalhos",-1)),y.value.length===0?(r(),o("div",R," Nenhum trabalho agendado ")):(r(),o("div",W,[(r(!0),o(D,null,x(y.value.slice(0,5),e=>(r(),o("div",{key:e.id,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},[t("div",null,[t("div",X,l(e.title),1),t("div",Z,l(e.location),1),e.scheduledDate?(r(),o("div",j," ðŸ“… "+l(e.scheduledDate.toLocaleDateString("pt-PT",{day:"2-digit",month:"2-digit",year:"numeric"}))+" Ã s "+l(e.scheduledDate.toLocaleTimeString("pt-PT",{hour:"2-digit",minute:"2-digit"})),1)):f("",!0)]),t("div",ee,[t("div",{class:m(["text-xs px-3 py-1 rounded-full font-black text-white",e.status==="pending"?"bg-yellow-600":e.status==="accepted"?"bg-blue-800":e.status==="in_progress"?"bg-green-800":"bg-gray-800"]),style:{"font-weight":"900","letter-spacing":"0.5px"}},l(e.status==="pending"?"PENDENTE":e.status==="accepted"?"AGENDADO":e.status==="in_progress"?"EM ANDAMENTO":"DESCONHECIDO"),3)])]))),128))]))])]))}}),ne=A(te,[["__scopeId","data-v-336628d8"]]);export{ne as default};
